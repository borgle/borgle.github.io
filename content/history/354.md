Title: ［分析］Global.asax带来方便的同时，带来了麻烦
Date: 2008-01-03 12:01:48
Modified: 2008-01-03 12:01:48
Category: Program
Tags: 应用程序,Application
Slug: 354
Authors: Yoker.Wu
Summary: 
    这段时间接触到一个算是大型一点的系统软件，感受非同一般呀，里面很多思想都是我曾经想要去尝试的，这次看了个够，不仅头晕，而且还头涨。多服务器负载，分布式数据库存储，全局缓存……，真不愧是一个已经运营过2年多的产品。
    详细的多服务器负载，分布式数据库存储等不会详细谈，也没有那么多时间来组织这些文字。这里看看他里面Global.asax给我调试附加程序带来的麻烦吧：


这段时间接触到一个算是大型一点的系统软件，感受非同一般呀，里面很多思想都是我曾经想要去尝试的，这次看了个够，不仅头晕，而且还头涨。多服务器负载，分布式数据库存储，全局缓存……，真不愧是一个已经运营过2年多的产品。

详细的多服务器负载，分布式数据库存储等不会详细谈，也没有那么多时间来组织这些文字。这里看看他里面Global.asax给我调试附加程序带来的麻烦吧：

全系统以缓存为基础，服务器端第一次启动会相当的慢，作者在这里还考虑到了多线程异步处理的方式，缓存加载完毕，系统运行就非常的流畅了。这些都不会给我带来什么问题，不过从别人使用软件的反馈信息来看，当管理者删除一个雇员或者修改一个雇员的名称的时候，所有其他管理者统统会掉线，也就是说服务器的Global.asax被重置了，也就是缓存被清空了一次。为什么会出现这样的情况呐？翻了无数的资料，最后找到下面的关键资料：<http://weblogs.asp.net/scottgu/archive/2005/12/14/433194.aspx>，文章中提到了<span style="color:Blue">a web.config file change, a global.asax change, an app_code directory change, a directory delete change, max-num-compilations reached quota, \bin directory change</span>等一些列都会导致这个问题，仔细跟踪代码后发现，修改雇员名称，删除雇员两个操作多会带来问题。

问题找到了，怎么解决了？显然Global.asax给我们带来了麻烦，利用自启动给我们带来的麻烦，<span style="color:Red">要么把Global.asax加载的过程放入其他地方，要么就是不要去删除目录或在更改目录名称</span>。除此之外，还真想不到其他什么办法了？你有什么好的建议，欢迎指点。。。